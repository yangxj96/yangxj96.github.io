import{M as R,_ as B,i as w}from"../../assets/index-zr023Hs_.js";import{u as M}from"../UseTable/UseTable.SqMQ832M.js";import{A as N}from"../AccountApi/AccountApi.swbyamOW.js";import{d as S,ah as a,o as i,c as f,T as e,O as t,S as _,H as P,M as C,F,a7 as z,Q as $,b as E,u as y,Z as T,ax as q,ay as x,a as D}from"../@vue/@vue.I-RMNdSZ.js";import"../pinia/pinia.RTuYtbS_.js";import"../vue-demi/vue-demi.C4xddsk9.js";import"../element-plus/element-plus.qvdORcwZ.js";import"../lodash-es/lodash-es.L7yb-_UW.js";import"../@element-plus/@element-plus.jJRl1ily.js";import"../@popperjs/@popperjs.-N-3kK7X.js";import"../@ctrl/@ctrl.ZggoHSuR.js";import"../dayjs/dayjs.nXyUZ0Ym.js";import"../async-validator/async-validator.BHjhHa7C.js";import"../memoize-one/memoize-one.JaOscZgY.js";import"../normalize-wheel-es/normalize-wheel-es.1urBKM79.js";import"../@floating-ui/@floating-ui.27iaWG4d.js";import"../axios/axios.QLjAsgXu.js";import"../vue-router/vue-router.K23cJQPm.js";import"../pinia-plugin-persistedstate/pinia-plugin-persistedstate.YzE7ESjF.js";import"//at.alicdn.com/t/c/font_3119163_oqg12xgkssd.js";const H=S({name:"SystemConfigRoutineEditor",props:{datum:{type:Object,required:!0}},data(){return{options:{datum:{}},form:{obj:{},rules:{value:[{required:!0,message:"请输入或选择值",trigger:"blur"}]}}}},methods:{onCancel(){this.$emit("close",!1)},async onSave(){await this.$refs.ruleForm.validate(l=>{l&&this.$message.success({...R,type:"success",onClose:()=>{this.onCancel()}})})},formatParams(){if(this.form.obj={...this.options.datum},this.form.obj.type===3){let l="";for(let o of this.form.obj.value)l+=o+",";l=l.substring(0,l.length-1),this.form.obj.value=l}return this.form.obj}},watch:{datum:{handler(l){this.options.datum=l,this.options.datum.type===3&&(this.options.datum.value=this.options.datum.value.split(","))},immediate:!0}}}),K={style:{height:"100%"}};function L(l,o,b,s,m,c){const u=a("el-input"),r=a("el-form-item"),g=a("el-option"),p=a("el-select"),V=a("el-form"),d=a("el-button"),k=a("el-dialog");return i(),f("div",K,[e(k,{"model-value":!0,"destroy-on-close":"",onClose:l.onCancel,title:`编辑[${l.options.datum.key}]`,width:"25%",class:"loading-box"},{footer:t(()=>[P(l.$slots,"footer",{},()=>[e(d,{type:"primary",onClick:l.onSave},{default:t(()=>[_("确定")]),_:1},8,["onClick"])])]),default:t(()=>[e(V,{ref:"ruleForm",model:l.options.datum,rules:l.form.rules,"label-width":"70px"},{default:t(()=>[e(r,{label:"id"},{default:t(()=>[e(u,{modelValue:l.options.datum.id,"onUpdate:modelValue":o[0]||(o[0]=n=>l.options.datum.id=n),disabled:""},null,8,["modelValue"])]),_:1}),e(r,{label:"配置键"},{default:t(()=>[e(u,{modelValue:l.options.datum.key,"onUpdate:modelValue":o[1]||(o[1]=n=>l.options.datum.key=n),disabled:""},null,8,["modelValue"])]),_:1}),l.options.datum.type===1?(i(),C(r,{key:0,label:"配置值",prop:"value"},{default:t(()=>[e(u,{modelValue:l.options.datum.value,"onUpdate:modelValue":o[2]||(o[2]=n=>l.options.datum.value=n),autosize:{minRows:2,maxRows:4},type:"textarea"},null,8,["modelValue"])]),_:1})):l.options.datum.type===2?(i(),C(r,{key:1,label:"配置值",prop:"value"},{default:t(()=>[e(p,{modelValue:l.options.datum.value,"onUpdate:modelValue":o[3]||(o[3]=n=>l.options.datum.value=n),placeholder:"请选择值",style:{width:"100%"}},{default:t(()=>[(i(!0),f(F,null,z(l.options.datum.items,n=>(i(),C(g,{key:n.value,label:n.name,value:n.value.toString()},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})):l.options.datum.type===3?(i(),C(r,{key:2,label:"配置值",prop:"value"},{default:t(()=>[e(p,{modelValue:l.options.datum.value,"onUpdate:modelValue":o[4]||(o[4]=n=>l.options.datum.value=n),placeholder:"请选择值",multiple:!0,style:{width:"100%"}},{default:t(()=>[(i(!0),f(F,null,z(l.options.datum.items,n=>(i(),C(g,{key:n.value,label:n.name,value:n.value.toString()},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})):$("",!0),e(r,{label:"说明"},{default:t(()=>[e(u,{modelValue:l.options.datum.remark,"onUpdate:modelValue":o[5]||(o[5]=n=>l.options.datum.remark=n),autosize:{minRows:6,maxRows:12},type:"textarea"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:3},8,["onClose","title"])])}const Q=B(H,[["render",L]]),Z={style:{height:"94%"}},G=S({__name:"index",setup(l){const{table_data:o,pagination:b,handleCurrentChange:s,handleSizeChange:m}=M(N.page),c=E({editor:{datum:{}}}),u=E({key:"",value:void 0});function r(g){c.value.editor.datum=g}return(g,p)=>{const V=a("el-input"),d=a("el-form-item"),k=a("el-button"),n=a("el-button-group"),I=a("el-form"),U=a("el-row"),h=a("el-table-column"),O=a("el-table"),A=a("el-pagination");return i(),f("div",Z,[e(U,{style:{height:"50px"}},{default:t(()=>[e(I,{inline:!0,model:u.value},{default:t(()=>[e(d,{label:"配置键"},{default:t(()=>[e(V,{modelValue:u.value.key,"onUpdate:modelValue":p[0]||(p[0]=v=>u.value.key=v),placeholder:"请输入配置键",clearable:!0},null,8,["modelValue"])]),_:1}),e(d,{label:"配置值"},{default:t(()=>[e(V,{modelValue:u.value.value,"onUpdate:modelValue":p[1]||(p[1]=v=>u.value.value=v),placeholder:"请输入配置键",clearable:!0},null,8,["modelValue"])]),_:1}),e(d,null,{default:t(()=>[e(n,null,{default:t(()=>[e(k,{type:"primary"},{default:t(()=>[e(w,{name:"icon-search"}),_(" 查询 ")]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),e(U,{style:{height:"calc(100% - 100px)"}},{default:t(()=>[e(O,{data:y(o),stripe:"",border:"",height:"100%",style:{width:"100%"}},{default:t(()=>[e(h,{label:"ID",prop:"id",width:"190",align:"center"}),e(h,{label:"配置键",prop:"key",align:"center"}),e(h,{label:"配置值",prop:"value_str",align:"center"}),e(h,{label:"值类型",prop:"type_str",align:"center"}),e(h,{label:"说明",prop:"remark",align:"center"}),e(h,{label:"操作",width:"130",align:"center"},{default:t(v=>[e(k,{text:"",type:"primary",onClick:ae=>r(v.row)},{default:t(()=>[e(w,{name:"icon-edit"}),_("  编辑 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])]),_:1}),e(U,{style:{float:"right",height:"50px"}},{default:t(()=>[e(A,{currentPage:y(b).page,"onUpdate:currentPage":p[2]||(p[2]=v=>y(b).page=v),"hide-on-single-page":"",background:"","page-sizes":y(b).page_sizes,layout:"sizes,prev, pager, next",total:y(b).total,onSizeChange:y(m),onCurrentChange:y(s)},null,8,["currentPage","page-sizes","total","onSizeChange","onCurrentChange"])]),_:1}),c.value.editor.datum.id?(i(),C(Q,{key:0,datum:c.value.editor.datum},null,8,["datum"])):$("",!0)])}}}),J={style:{height:"100%"}},W={key:0},X={key:1},Y=S({__name:"index",setup(l){const o=T({access_id:"access_id",access_secret:"access_secret",bucket:"bucket",locale:"/opt/file/img",type:0});return(b,s)=>{const m=a("el-radio"),c=a("el-radio-group"),u=a("el-form-item"),r=a("el-input"),g=a("el-button"),p=a("el-form"),V=a("el-col");return i(),f("div",J,[e(V,{span:12,offset:6},{default:t(()=>[e(p,{modelValue:o,"onUpdate:modelValue":s[5]||(s[5]=d=>o=d),"label-width":"120px"},{default:t(()=>[e(u,{label:"存储方式"},{default:t(()=>[e(c,{modelValue:o.type,"onUpdate:modelValue":s[0]||(s[0]=d=>o.type=d)},{default:t(()=>[e(m,{label:0},{default:t(()=>[_("本地存储")]),_:1}),e(m,{label:1},{default:t(()=>[_("阿里云OSS")]),_:1}),e(m,{label:2},{default:t(()=>[_("腾讯云COS")]),_:1}),e(m,{label:3},{default:t(()=>[_("七牛云KODO")]),_:1}),e(m,{label:4},{default:t(()=>[_("MinIO")]),_:1})]),_:1},8,["modelValue"])]),_:1}),o.type===0?(i(),f("div",W,[e(u,{label:"请输入本地位置"},{default:t(()=>[e(r,{modelValue:o.locale,"onUpdate:modelValue":s[1]||(s[1]=d=>o.locale=d)},null,8,["modelValue"])]),_:1})])):$("",!0),o.type!==0?(i(),f("div",X,[e(u,{label:"AccessID"},{default:t(()=>[e(r,{modelValue:o.access_id,"onUpdate:modelValue":s[2]||(s[2]=d=>o.access_id=d)},null,8,["modelValue"])]),_:1}),e(u,{label:"AccessSecret"},{default:t(()=>[e(r,{modelValue:o.access_secret,"onUpdate:modelValue":s[3]||(s[3]=d=>o.access_secret=d)},null,8,["modelValue"])]),_:1}),e(u,{label:"存储桶名称"},{default:t(()=>[e(r,{modelValue:o.bucket,"onUpdate:modelValue":s[4]||(s[4]=d=>o.bucket=d)},null,8,["modelValue"])]),_:1})])):$("",!0),e(u,null,{default:t(()=>[e(g,{type:"primary"},{default:t(()=>[_("保存")]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})])}}}),j=l=>(q("data-v-266f2d07"),l=l(),x(),l),ee={style:{height:"100%"}},te=j(()=>D("span",null," 平台属性配置",-1)),le=j(()=>D("span",null," 文件存储配置",-1)),oe=S({__name:"index",setup(l){const o=E("routine");return(b,s)=>{const m=a("el-tab-pane"),c=a("el-tabs");return i(),f("div",ee,[e(c,{modelValue:o.value,"onUpdate:modelValue":s[0]||(s[0]=u=>o.value=u)},{default:t(()=>[e(m,{name:"routine"},{label:t(()=>[e(w,{name:"icon-setting",style:{color:"#4d4d4d"}}),te]),default:t(()=>[e(G)]),_:1}),e(m,{name:"file"},{label:t(()=>[e(w,{name:"icon-file-config",style:{color:"#4d4d4d"}}),le]),default:t(()=>[e(Y)]),_:1})]),_:1},8,["modelValue"])])}}}),$e=B(oe,[["__scopeId","data-v-266f2d07"]]);export{$e as default};
